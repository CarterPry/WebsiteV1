---
title: "The sudo vulnerability (CVE-2023-22809)"
date: 2023-03-02 30:35:30 +0100
description: "That one linux command, has fallen to the CVEs"
summary: "That one linux command, has fallen to the CVEs"
tags: ["linux", "Vulnerability"]
---

## Cve-2023-22809
For most Linux users, one of the most used commands is the amazing “sudo”. Unless you’re an Arch user… then, “neofetch” takes over. sudo has been compromised with a vulnerability called [Cve-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809), a vulnerability that allows threat actors to edit files that they’re not supposed to with the ‘sudoedit’ command. This decently high risk vulnerability that has a base score of 7.8. This is a big risk because with an exploit like this, the attacker can edit certain files, including the ‘/etc/passwd’ or ‘/etc/group,’ to further gain access that they should not be having.

## How Does It Work?
It’s not as scary as it sounds, In order for an attacker to use this CVE, they would already need to have access to the computer Lan. If they were able to get onto a guest account, or any account for that matter, they could escalate their privileges. All they need is a terminal on your computer to run a certain command. Here’s an example of editing the ‘/etc/passwd’ file would look like without the proper access:

```json
EDITOR='nano -- /etc/group' sudoedit /etc/motd
```

How does it work? Calling the editing tool within the quotations and adding the ‘--’ afterwards helps trick the front end into thinking that proper authorization is being used. With only a simple ‘--’ trick, you can do a lot of messy things from adding your own account to the sudo group to even revoking the main user’s root privileges. When using the ‘sudoedit’ command, the ‘--’ messes with the parameters of the command usage and tricks your system into thinking that everything that comes after it should be edited even if the ‘sudoedit’ command generally wouldn’t allow the file to be messed with.

## Another Example
Let's say I want to modify the /etc/group file on your system. My victim has a user account with sudo privileges that allows them to use the ‘sudoedit’ command to edit their “thought to be safe” files. The sudoers policy is what allows them to edit /etc/motd using ‘sudoedit.’

I can write a command to exploit this concept and set the EDITOR environment variable to any text editor of choice by placing the ‘--’ argument afterwards. This sets the path to the file they want to modify. For example, I might write something like this:

```json
EDITOR='vim -- /etc/passwd' sudoedit /etc/motd
```

EDITOR = 'vim -- /etc/passwd' sets the EDITOR environment variable to vim -- /etc/passwd, where vim is what I’m using to write and -- /etc/passwd is my target file.

sudoedit /etc/motd, allows me to run the ‘sudoedit’ command with the /etc/motd file as the target. Normally, this command would allow me to edit the /etc/motd file with elevated privileges, as once again specified by the sudoers configuration. However, due to our ‘--’ argument, the EDITOR environment variable tricks the sudo front-end into treating everything after it as a file edited by me. This lets me get past the sudo policy, even though the sudoers policy only allows me to edit /etc/motd. With something as simple as that, I can now edit any file.

## Mitigation

To check if you still have this vulnerability on your system you can run the following command:

```json
sudo –version
```

If the output lists any version within the 1.8.0-1.9.12p1 range, then you need to update your system. Almost all major distros have patched this problem, so the easiest fix for a solution would be to update everything. Just like any other scary vulnerability, when released, it tends to get patched pretty fast. So, unless you want to test it for yourself, just update your system, and you’ll be fine. In fact, update your system right now!






